#!/bin/bash

prefix=$1

# source common functions
if [ -e /usr/lib/xen-tools/common.sh ]; then
    . /usr/lib/xen-tools/common.sh
else
    echo "Installation problem in $0"
fi

logMessage Script $0 starting
logMessage "${0}: Overwriting /etc/apt/sources.list with StuSta mirrors"


cat > ${prefix}/etc/apt/sources.list <<EOF
# StuSta mirrors
#
# Generated by 10-apt-sources

deb http://mirror.stusta.mhn.de/debian-security/ squeeze/updates main contrib non-free
deb-src http://mirror.stusta.mhn.de/debian-security/ squeeze/updates main contrib non-free

deb http://mirror.stusta.mhn.de/debian/ squeeze main contrib non-free
deb-src http://mirror.stusta.mhn.de/debian/ squeeze main contrib non-free

deb http://mirror.stusta.mhn.de/debian/ squeeze-updates main contrib non-free
deb-src http://mirror.stusta.mhn.de/debian/ squeeze-updates main contrib non-free
EOF

chroot ${prefix} aptitude update

logMessage "$0 finished setting mirrors "
